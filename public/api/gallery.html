<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://unpkg.com/packery@2/dist/packery.pkgd.min.js"></script>
        <script src="https://unpkg.com/draggabilly@3/dist/draggabilly.pkgd.min.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css">
        <title>Gallery</title>
    </head>
    <body >
        <main>
            <div class="btn-group-vertical bg-dark" role="group" aria-label="Vertical button group">
                  <ul class="nav nav-pills nav-flush flex-column mb-auto text-center">
                    <li class="nav-item bg-dark">
                      <a href="#" class="nav-link py-3  rounded-0" aria-current="page" title="Home" data-bs-toggle="tooltip" data-bs-placement="right">
                        <img src="https://res.cloudinary.com/ddriyyppm/image/upload/v1672267417/house-door_zrpguk.svg" alt="Bootstrap" width="30" height="24" class="">
                      </a>
                    </li>
                    <li class="nav-item bg-dark">
                      <a href="#" class="nav-link py-3  rounded-0" title="Dashboard" data-bs-toggle="tooltip" data-bs-placement="right">
                        <img src="https://res.cloudinary.com/ddriyyppm/image/upload/v1672267417/house-door_zrpguk.svg" alt="Bootstrap" width="30" height="24" class="">
                      </a>
                    </li>
                    <li class="nav-item bg-dark">
                      <a href="#" class="nav-link py-3  rounded-0" title="Orders" data-bs-toggle="tooltip" data-bs-placement="right">
                        <img src="https://res.cloudinary.com/ddriyyppm/image/upload/v1672267417/house-door_zrpguk.svg" alt="Bootstrap" width="30" height="24" class="">
                      </a>
                    </li>
                    <li class="nav-item bg-dark">
                      <a href="#" class="nav-link py-3  rounded-0" title="Products" data-bs-toggle="tooltip" data-bs-placement="right">
                        <img src="https://res.cloudinary.com/ddriyyppm/image/upload/v1672267417/house-door_zrpguk.svg" alt="Bootstrap" width="30" height="24" class="">
                      </a>
                    </li>
                    <li class="nav-item bg-dark">
                      <a href="#" class="nav-link py-3  rounded-0" title="Customers" data-bs-toggle="tooltip" data-bs-placement="right">
                        <img src="https://res.cloudinary.com/ddriyyppm/image/upload/v1672267417/house-door_zrpguk.svg" alt="Bootstrap" width="30" height="24" class="">
                      </a>
                    </li>
                  </ul>
              </div>
            
              <div id="images">
                <div class="grid">
                  <!--<div class="grid-item bg-dark grid-item--width2"></div>
                  <div class="glass grid-item grid-sizer"><div class="glass-border d-flex justify-content-center align-items-center"><img src="./img/img1.jpg"alt=""></div></div>
                  <div class="gridbg-dark grid-item--height2"></div>-->
                  <dir id="last"></dir>
                  <form action="/upload" enctype="multipart/form-data" method="POST" id="uploadForm">
                    <div class="drag-area grid-item grid-item--width3">
                      <div class="icon"><i class="fas fa-cloud-upload-alt"></i></div>
                      <header>Drag & Drop to Upload File</header>
                      <span>OR</span>
                      <button type="button" class="uploadButton">Browse File</button>
                      <input type="file" name="image" id="uploadHidden" hidden>
                      <br>
                      <input type="submit" value="SEND" class="uploadButton">
                    </div>
                  </form>
                </div>
            </div>
        </main>
        <script>
          //drag
          var pckry = new Packery( '.grid', {
            itemSelector: '.grid-item',
            columnWidth: '.grid-sizer',
            transitionDuration: 0,
            percentPosition: true,
            //gutter: 3
          });
          pckry.getItemElements().forEach( function( itemElem ) {
            var draggie = new Draggabilly( itemElem );
            pckry.bindDraggabillyEvents( draggie );
          });
          
          //selecting all required elements
          const dropArea = document.querySelector(".drag-area"),
          dragText = dropArea.querySelector("header"),
          button = dropArea.querySelector("button");
          const input = document.getElementById('uploadHidden');
          const form = document.getElementById('uploadForm');
          let file; //this is a global variable used inside multiple functions

          button.onclick = ()=>{
            input.click(); //if user click on the button then the input also clicked
          }
          input.addEventListener("change", function(){
            //getting user select file and [0] this means if user select multiple files then we'll select only the first one
            file = this.files[0];
            dropArea.classList.add("active");
            showFile(); //calling function
          });
          //If user Drag File Over DropArea
          dropArea.addEventListener("dragover", (event)=>{
            event.preventDefault(); //preventing from default behaviour
            dropArea.classList.add("active");
            dragText.textContent = "Release to Upload File";
          });
          //If user leave dragged File from DropArea
          dropArea.addEventListener("dragleave", ()=>{
            dropArea.classList.remove("active");
            dragText.textContent = "Drag & Drop to Upload File";
          });
          //If user drop File on DropArea
          dropArea.addEventListener("drop", (event)=>{
            event.preventDefault(); //preventing from default behaviour
            //getting user select file and [0] this means if user select multiple files then we'll select only the first one
            file = event.dataTransfer.files[0];
            showFile(); //calling function
          });
          function showFile(){
            let fileType = file.type; //getting selected file type
            let validExtensions = ["image/jpeg", "image/jpg", "image/png"]; //adding some valid image extensions in array
            if(validExtensions.includes(fileType))
            { 
              const dT = new DataTransfer();
              dT.items.add(file);
              input.files = dT.files;
              let fileSize = input.files[0].size;
              fileSize = fileSize/1024/1024
              console.log(fileSize, 'filesize');
              if(fileSize < 4.5)
              {
                dropArea.classList.remove("active");
                dragText.textContent = "Drag & Drop to Upload File";
              }
              else
              {
                form.reset();
                alert("The file must be under 4.5 MB");
                dropArea.classList.remove("active");
                dragText.textContent = "Drag & Drop to Upload File";
              }
            }
            else
            {
              alert("This is not an Image File!");
              dropArea.classList.remove("active");
              dragText.textContent = "Drag & Drop to Upload File";
            }
          }
        </script>
    </body>
</html>